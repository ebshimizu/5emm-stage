"use strict";(globalThis["webpackChunk_5e_monster_maker"]=globalThis["webpackChunk_5e_monster_maker"]||[]).push([[943],{1137:(e,l,t)=>{t.r(l),t.d(l,{default:()=>J});var a=t(9835),o=t(6970),s=t(1957);const i={class:"text-h6"};function n(e,l,t,n,r,d){const m=(0,a.up)("q-space"),p=(0,a.up)("q-btn"),c=(0,a.up)("q-checkbox"),u=(0,a.up)("q-td"),g=(0,a.up)("q-select"),w=(0,a.up)("q-popup-edit"),v=(0,a.up)("q-input"),f=(0,a.up)("q-tr"),b=(0,a.up)("q-table"),k=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(k,{style:{"min-height":"calc(100vh - 120px)"}},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{selected:e.selected,"onUpdate:selected":l[0]||(l[0]=l=>e.selected=l),title:e.$t("editor.spellcasting.custom.title"),rows:e.spells,columns:e.columns,pagination:{rowsPerPage:15},"row-key":"name",class:"q-mx-auto q-my-md",selection:"multiple",style:{width:"98vw"}},{top:(0,a.w5)((()=>[(0,a._)("div",i,(0,o.zw)(e.$t("editor.spellcasting.custom.title")),1),(0,a.Wm)(m),(0,a.wy)((0,a.Wm)(p,{color:"negative",class:"q-mr-md",onClick:e.deleteSpells},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("editor.spellcasting.custom.delete",e.selected.length)),1)])),_:1},8,["onClick"]),[[s.F8,0!==e.selected.length]]),(0,a.Wm)(p,{color:"primary",class:"q-mr-md",onClick:e.importSpells},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("editor.spellcasting.custom.import")),1)])),_:1},8,["onClick"]),(0,a.Wm)(p,{color:"primary",class:"q-mr-md",onClick:e.downloadSpells},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("editor.spellcasting.custom.export")),1)])),_:1},8,["onClick"]),(0,a.Wm)(p,{color:"positive",onClick:e.addSpell},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("editor.spellcasting.custom.create")),1)])),_:1},8,["onClick"])])),body:(0,a.w5)((l=>[(0,a.Wm)(f,{props:l},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:l.selected,"onUpdate:modelValue":e=>l.selected=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,a.Wm)(u,{key:"name",props:l},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.row.name),1)])),_:2},1032,["props"]),(0,a.Wm)(u,{key:"level",props:l,class:"editable"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.cols[1].format(l.row.level))+" ",1),(0,a.Wm)(w,{modelValue:l.row.level,"onUpdate:modelValue":e=>l.row.level=e,"auto-save":"",title:e.$t("editor.spellcasting.custom.level")},{default:(0,a.w5)((l=>[(0,a.Wm)(g,{modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,options:e.spellOptions,"emit-value":"","map-options":"",label:e.$t("editor.spellcasting.custom.level")},null,8,["modelValue","onUpdate:modelValue","options","label"])])),_:2},1032,["modelValue","onUpdate:modelValue","title"])])),_:2},1032,["props"]),(0,a.Wm)(u,{key:"class",props:l,class:"editable"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.cols[2].format(l.row.class))+" ",1),(0,a.Wm)(w,{modelValue:l.row.class,"onUpdate:modelValue":e=>l.row.class=e,"auto-save":"",title:e.$t("editor.spellcasting.custom.classes")},{default:(0,a.w5)((l=>[(0,a.Wm)(g,{modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,options:e.SrdCastingClassOptions,multiple:"",clearable:"","emit-value":"","map-options":"","new-value-mode":"add-unique","use-input":"",label:e.$t("editor.spellcasting.custom.classes"),onClear:e=>l.value=[]},null,8,["modelValue","onUpdate:modelValue","options","label","onClear"])])),_:2},1032,["modelValue","onUpdate:modelValue","title"])])),_:2},1032,["props"]),(0,a.Wm)(u,{key:"damage",props:l,class:"editable"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.row.damage)+" ",1),(0,a.Wm)(w,{modelValue:l.row.damage,"onUpdate:modelValue":e=>l.row.damage=e,"auto-save":"",title:e.$t("editor.spellcasting.custom.damage")},{default:(0,a.w5)((l=>[(0,a.Wm)(v,{"model-value":l.value,type:"number",min:"0",label:e.$t("editor.spellcasting.custom.damage"),"onUpdate:modelValue":t=>l.value=e.validateNumber(t,0)},null,8,["model-value","label","onUpdate:modelValue"])])),_:2},1032,["modelValue","onUpdate:modelValue","title"])])),_:2},1032,["props"]),(0,a.Wm)(u,{key:"multitarget",props:l},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.cols[4].format(l.row.multitarget)),1)])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["selected","title","rows","columns"])])),_:1})}var r=t(9302),d=t(6869),m=t(3228),p=t(2395),c=t(499),u=t(7712),g=t(5594),w=t(4409),v=t.n(w),f=t(593);const b={class:"text-h6"},k={class:"col-12 flex items-center"};function C(e,l,t,s,i,n){const r=(0,a.up)("q-card-section"),d=(0,a.up)("q-separator"),m=(0,a.up)("q-file"),p=(0,a.up)("q-toggle"),c=(0,a.up)("q-btn"),u=(0,a.up)("q-card-actions"),g=(0,a.up)("q-card"),w=(0,a.up)("q-dialog");return(0,a.wg)(),(0,a.j4)(w,{ref:"dialogRef",onHide:e.onDialogHide},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"q-dialog-plugin import-spell-dialog"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a._)("div",b,(0,o.zw)(e.$t("editor.spellcasting.custom.importDialog")),1)])),_:1}),(0,a.Wm)(d),(0,a.Wm)(r,{class:"row"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{modelValue:e.file,"onUpdate:modelValue":l[0]||(l[0]=l=>e.file=l),class:"q-pa-md col-12",label:e.$t("editor.spellcasting.custom.importFile"),accept:".5emms.json"},null,8,["modelValue","label"]),(0,a._)("div",k,[(0,a.Wm)(p,{modelValue:e.overwrite,"onUpdate:modelValue":l[1]||(l[1]=l=>e.overwrite=l),label:e.$t("editor.spellcasting.custom.importMode")},null,8,["modelValue","label"])])])),_:1}),(0,a.Wm)(u,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"green",label:e.$t("editor.spellcasting.custom.import"),disabled:null==e.file,onClick:e.onOKClick},null,8,["label","disabled","onClick"]),(0,a.Wm)(c,{color:"primary",label:e.$t("editor.cancel"),onClick:e.onCancelClick},null,8,["label","onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}var V=t(4182),_=t(4303),y=t(3774);const W=(0,a.aZ)({name:"LoadSpellsDialog",emits:[...V.Z.emits],setup(){const{dialogRef:e,onDialogHide:l,onDialogOK:t,onDialogCancel:a}=(0,V.Z)(),o=(0,r.Z)(),{t:s}=(0,u.QT)(),i=(0,p.i)(),n=(0,c.iH)(),d=(0,c.iH)(!1),m=()=>{if(null!=n.value){const e=new FileReader;e.addEventListener("load",(e=>{try{const l=JSON.parse(e.target?.result),t=Array.isArray(l)?y.T.v1:y.T.v2,a=(0,_.G)(l,t);if(a.valid){const e=i.import(Array.isArray(l)?l:Object.values(l),d.value);o.notify({message:s("editor.spellcasting.custom.importResult",{n:e.imported},e.imported),type:"positive"}),e.skipped>0&&o.notify({message:s("editor.spellcasting.custom.importSkip",{n:e.skipped},e.skipped),type:"warning"})}else o.notify({message:s("editor.spellcasting.custom.importInvalid",[a.errors.map((e=>e.stack)).join(", ")]),type:"negative"}),console.error(a.errors)}catch(e){o.notify({message:s("editor.spellcasting.custom.importError",[e]),type:"negative"}),console.error(e)}})),e.addEventListener("error",(e=>{o.notify({message:s("editor.spellcasting.custom.importError",[e]),type:"negative"}),console.error(e)})),e.readAsText(n.value)}};return{dialogRef:e,onDialogHide:l,onOKClick(){m(),t()},onCancelClick:a,spellStore:i,file:n,overwrite:d}}});var q=t(1639),Z=t(2074),U=t(4458),S=t(3190),Q=t(926),h=t(3837),$=t(3175),O=t(1821),z=t(8879),T=t(9984),j=t.n(T);const x=(0,q.Z)(W,[["render",C]]),D=x;j()(W,"components",{QDialog:Z.Z,QCard:U.Z,QCardSection:S.Z,QSeparator:Q.Z,QFile:h.Z,QToggle:$.Z,QCardActions:O.Z,QBtn:z.Z});var H=t(7445);const E=(0,a.aZ)({name:"SpellsEditor",setup(){const{t:e}=(0,u.QT)(),l=(0,r.Z)(),t=(0,p.i)(),{ordinalSpellLevels:o,spellOptions:s}=(0,d.G)(),i=(0,c.iH)([]),n=(0,a.Fl)((()=>Object.values(t.customSpells))),{SrdCastingClassOptions:w}=(0,m.F)(),b=[{name:"name",field:"name",required:!0,label:e("editor.spellcasting.custom.name"),align:"left",sortable:!0},{name:"level",label:e("editor.spellcasting.custom.level"),sortable:!0,field:e=>e.level,format:l=>0===l?e("editor.spellcasting.slot.cantrip"):e("editor.spellcasting.slot.level",{ordinal:o[l]})},{name:"class",label:e("editor.spellcasting.custom.classes"),sortable:!1,field:"class",format:e=>e.map((e=>v().capitalize(e))).join(", ")},{name:"damage",label:e("editor.spellcasting.custom.damage"),sortable:!0,field:"damage"},{name:"multitarget",label:e("editor.spellcasting.custom.multitarget"),sortable:!1,field:"multitarget",format:l=>e(l?"editor.spellcasting.custom.mtTrue":"editor.spellcasting.custom.mtFalse")}],k=()=>{l.dialog({component:g.Z})},C=()=>{i.value.forEach((e=>t.deleteSpell(e.name))),i.value=[]},V=()=>{(0,f.L)(JSON.stringify(t.customSpells),"custom-spells.5emms.json","application/json")},_=()=>{l.dialog({component:D})};return{spells:n,columns:b,selected:i,spellOptions:s,SrdCastingClassOptions:w,addSpell:k,deleteSpells:C,downloadSpells:V,importSpells:_,validateNumber:H.m}}});var F=t(9885),A=t(953),L=t(136),R=t(9546),N=t(7220),P=t(1221),I=t(9843),K=t(6384),B=t(3119);const G=(0,q.Z)(E,[["render",n],["__scopeId","data-v-f5e61e70"]]),J=G;j()(E,"components",{QPage:F.Z,QTable:A.Z,QSpace:L.Z,QBtn:z.Z,QTr:R.Z,QTd:N.Z,QCheckbox:P.Z,QPopupEdit:I.Z,QSelect:K.Z,QInput:B.Z})}}]);